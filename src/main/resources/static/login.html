<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¡œê·¸ì¸</title>
  <style>
    body { font-family: Arial; max-width: 400px; margin: 2rem auto; padding: 1rem; }
    input, button { display: block; margin: 0.5rem 0; padding: 0.5rem; width: 100%; }
    .result { white-space: pre-wrap; margin-top: 1rem; }
  </style>
</head>
<body>
<h1>ğŸ¬ Cinema ë¡œê·¸ì¸</h1>

<input type="text" id="login-username" placeholder="ì•„ì´ë””">
<input type="password" id="login-password" placeholder="ë¹„ë°€ë²ˆí˜¸">
<button onclick="login()">ë¡œê·¸ì¸</button>

<div class="result" id="login-result"></div>

<hr>
<button onclick="goToSignup()">íšŒì›ê°€ì… í˜ì´ì§€ë¡œ ì´ë™</button>

<script>
  function authFetch(url, options = {}) {
    const token = localStorage.getItem("token");
    return fetch(url, {
      ...options,
      headers: {
        ...(options.headers || {}),
        Authorization: token
      }
    });
  }

  async function login() {
    const username = document.getElementById("login-username").value;
    const password = document.getElementById("login-password").value;
    const res = await fetch("/auth/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password })
    });
    const result = document.getElementById("login-result");
    const token = res.headers.get("Authorization");
    const text = await res.text();
    if (res.ok && token) {
      localStorage.setItem("token", token);
      window.location.href = "/boxoffice.html";
    } else {
      result.innerText = `âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨ (${res.status})\n${text}`;
    }
  }

  function goToSignup() {
    window.location.href = "/signup.html";
  }
</script>
</body>
</html>
